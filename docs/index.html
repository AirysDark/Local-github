<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>⚙️ Local-Github OS Builder</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, sans-serif;
      background-color: #0d1117;
      color: #e6edf3;
      margin: 0;
      padding: 20px;
    }
    h1, h2 {
      color: #58a6ff;
    }
    .section {
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: bold;
    }
    select, input {
      width: 100%;
      padding: 8px;
      background: #0d1117;
      border: 1px solid #30363d;
      border-radius: 6px;
      color: #e6edf3;
    }
    button {
      background: #238636;
      color: white;
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 20px;
    }
    button:hover {
      background: #2ea043;
    }
  </style>
</head>
<body>
  <h1>⚙️ Local-Github OS Builder</h1>

  <!-- Build Target -->
  <div class="section">
    <h2>🖥️ Build Target</h2>
    <label for="target_bits">Device & Bitrate</label>
    <select id="target_bits">
      <option value="pi 64bit">🍓 Pi 64bit</option>
      <option value="pi 32bit">🍓 Pi 32bit</option>
      <option value="pc 64bit">💻 PC 64bit</option>
      <option value="pc 32bit">💻 PC 32bit</option>
      <option value="android">🤖 Android</option>
      <option value="i860">⚡ Intel i860</option>
      <option value="arm64">🛡️ ARM64</option>
      <option value="armhf">⚙️ ARMhf</option>
      <option value="riscv64">🚀 RISC-V 64</option>
      <option value="i386">💾 i386</option>
    </select>
  </div>

  <!-- User -->
  <div class="section">
    <h2>👤 User</h2>
    <label for="user_name">Username</label>
    <input type="text" id="user_name" placeholder="e.g. AirysDark">
    <label for="user_password">Password</label>
    <input type="password" id="user_password" placeholder="••••••••">
  </div>

  <!-- Wi-Fi -->
  <div class="section">
    <h2>📶 Wi-Fi</h2>
    <label for="wifi_ssid">SSID</label>
    <input type="text" id="wifi_ssid" placeholder="e.g. Raspbain">
    <label for="wifi_password">Password</label>
    <input type="password" id="wifi_password" placeholder="••••••••">
    <label for="static_ip">Static IPv4</label>
    <input type="text" id="static_ip" placeholder="192.168.0.130">
    <label for="gateway">Gateway</label>
    <input type="text" id="gateway" placeholder="192.168.0.1">
    <label for="dns">DNS Servers (semicolon-separated)</label>
    <input type="text" id="dns" placeholder="1.1.1.1;8.8.8.8">
  </div>

  <!-- SSH -->
  <div class="section">
    <h2>🔐 SSH</h2>
    <label for="ssh_permit_root_login">PermitRootLogin</label>
    <select id="ssh_permit_root_login">
      <option value="yes">✅ Yes</option>
      <option value="no">❌ No</option>
    </select>
    <label for="ssh_password_auth">PasswordAuthentication</label>
    <select id="ssh_password_auth">
      <option value="yes">✅ Yes</option>
      <option value="no">❌ No</option>
    </select>
    <label for="ssh_pubkey_auth">PubkeyAuthentication</label>
    <select id="ssh_pubkey_auth">
      <option value="yes">✅ Yes</option>
      <option value="no">❌ No</option>
    </select>
  </div>

  <!-- Region & Locale -->
  <div class="section">
    <h2>🌍 Region & Locale</h2>
    <label for="wifi_country">Wi-Fi Country</label>
    <select id="wifi_country"></select>

    <label for="timezone">Timezone</label>
    <select id="timezone"></select>

    <label for="keyboard">Keyboard Layout</label>
    <select id="keyboard"></select>

    <label for="keyboard_custom">Custom Keyboard (if layout=custom)</label>
    <input type="text" id="keyboard_custom" placeholder="e.g. us,intl">
  </div>

  <!-- Submit -->
  <button onclick="triggerBuild()">🚀 Start Build</button>

  <script>
    async function loadOptions() {
      const [countries, timezones, keyboards] = await Promise.all([
        fetch('config/countries.json').then(r => r.json()),
        fetch('config/timezones.json').then(r => r.json()),
        fetch('config/keyboards.json').then(r => r.json())
      ]);

      const countrySelect = document.getElementById('wifi_country');
      countries.forEach(c => {
        const opt = document.createElement('option');
        opt.value = c.code;
        opt.textContent = `${c.flag} ${c.name} (${c.code})`;
        countrySelect.appendChild(opt);
      });

      const timezoneSelect = document.getElementById('timezone');
      timezones.forEach(tz => {
        const opt = document.createElement('option');
        opt.value = tz;
        opt.textContent = tz;
        timezoneSelect.appendChild(opt);
      });

      const keyboardSelect = document.getElementById('keyboard');
      keyboards.forEach(k => {
        const opt = document.createElement('option');
        opt.value = k;
        opt.textContent = k;
        keyboardSelect.appendChild(opt);
      });
    }

    function triggerBuild() {
      // collect values
      const payload = {
        ref: "main",
        inputs: {
          target_bits: document.getElementById('target_bits').value,
          user_name: document.getElementById('user_name').value,
          user_password: document.getElementById('user_password').value,
          wifi_ssid: document.getElementById('wifi_ssid').value,
          wifi_password: document.getElementById('wifi_password').value,
          static_ip: document.getElementById('static_ip').value,
          gateway: document.getElementById('gateway').value,
          dns: document.getElementById('dns').value,
          ssh_permit_root_login: document.getElementById('ssh_permit_root_login').value,
          ssh_password_auth: document.getElementById('ssh_password_auth').value,
          ssh_pubkey_auth: document.getElementById('ssh_pubkey_auth').value,
          wifi_country: document.getElementById('wifi_country').value,
          timezone: document.getElementById('timezone').value,
          keyboard: document.getElementById('keyboard').value,
          keyboard_custom: document.getElementById('keyboard_custom').value,
        }
      };
      console.log("Build payload:", payload);
      alert("🚧 This will trigger the GitHub Actions workflow!\n\nCheck console for JSON payload.");
    }

    loadOptions();
  </script>
</body>
</html>
